<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>The Editor</title>

  <style>
    * {
      padding: 10px;
      /* margin: 5px; */
    }
    body {
      font-family: sans-serif;
    }
    #output {
      border: 1px solid black;
      overflow-x: scroll;
    }
    .h {
      visibility: hidden;
    }
    #c {
      color: #777;
    }
    #x {
      font-weight: bold;
      font-size: 30px;
      padding:0;
    }
    #check {
      margin-left: 30px;
    }
  </style>
</head>

<body>

  <div style='margin-bottom:0'>
    <span id='x'>Vanilla HTML Editor</span>
    <input onchange='y()' type="checkbox" id="check" checked>
    <span>save to localStorage</span>
  </div>

  <span id='c'></span>
  <br><br>
  <br>
  <b>IN :</b>
  <br>
  <textarea placeholder="Write some HTML..." oninput='x()'
    id="input" cols="100" rows="15"></textarea>
  <br><br>
  <b>OUT :</b>
  <br>
  <br>
<div class='h' id='output'></div>
<script>

let output = document.getElementById('output')
let input = document.getElementById('input')
let save = document.getElementById('c')
let check = document.getElementById('check')

let count = false

if (localStorage.getItem('save_hfksjd') !== null) {
  check.checked = bool(localStorage.getItem('save_hfksjd'))
  input.value = localStorage.getItem('x_haskljdhf')
  x()
} else {
  localStorage.setItem('save_hfksjd', true)
}


setInterval(() => {
  if (count) count = false
  if (bool(localStorage.getItem('save_hfksjd'))) {
    setTimeout(() => save.innerHTML = 'All changes saved.', 800)
  }
}, 800)

function bool(str) {
  return true ? str === 'true' : false
}

function y() {
  localStorage.setItem('save_hfksjd', check.checked)
}

function x() {
  if (input.value === '') {
    output.className = 'h'
  } else {
    output.className = ''
  }
  output.innerHTML = input.value
  if (bool(localStorage.getItem('save_hfksjd'))) {
    save.innerHTML = 'Saving to localStorage...'
    if (!count) {
      localStorage.setItem('x_haskljdhf', input.value)
      count = true
    }
  } else {
    save.innerHTML = 'New changes are unsaved'
  }
}

if (localStorage.getItem('x_haskljdhf') !== null) {
  input.value = localStorage.getItem('x_haskljdhf')
  x()
}

</script>

</body>

</html>
